---
title: "PART A"
author: "MIKE"
date: "2026-02-16"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Reading Data and Data Cleaning

```{r}
my_data = read.csv("tele.csv")
str(my_data)

# Add new flag of whether the customer was contacted
#my_data$was_contacted = ifelse(my_data$pdays == 999, 0, 1)

## ciao ciao
# random line
#test2 
# test andrea
removes = c("X", "duration") # duration is unknown when calling
to_be_factors = c("job", "marital", "education", "default", "housing", "loan", "contact", "month", "day_of_week", "poutcome", "y")

my_data[removes] = NULL
my_data[to_be_factors] = lapply(my_data[to_be_factors], factor)


summary(my_data)
```

### Split Data into training and testing

```{r}
ratio = 0.7
set.seed(12345) 
train_rows = sample(1:nrow(my_data), ratio*nrow(my_data))
training = my_data[train_rows, ]
testing = my_data[-train_rows, ]
```

### Logistic model creation

```{r}
linear_model = glm(y ~ ., data = training, family = binomial)
stepmodel = step(linear_model, direction = "backward", trace = 0)
```

### Make predictions

```{r}
prob = predict(stepmodel, testing, type = "response")
pred = ifelse(prob >= 0.5, "yes", "no")
pred = factor(pred, levels = levels(testing$y))
```

### Evaluation

```{r}
library(caret)
confusionMatrix(pred, testing$y, positive = "yes")
#testing
```












